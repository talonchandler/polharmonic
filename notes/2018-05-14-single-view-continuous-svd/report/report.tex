
\documentclass[11pt]{article}

%%%%%%%%%%%%
% Packages %
%%%%%%%%%%%%
\usepackage[dvipsnames]{xcolor}
\hyphenpenalty=10000
\usepackage{tikz}
\usetikzlibrary{shapes,arrows}

\usepackage{tocloft}
\renewcommand\cftsecleader{\cftdotfill{\cftdotsep}}
\def\undertilde#1{\mathord{\vtop{\ialign{##\crcr
$\hfil\displaystyle{#1}\hfil$\crcr\noalign{\kern1.5pt\nointerlineskip}
$\hfil\tilde{}\hfil$\crcr\noalign{\kern1.5pt}}}}}
\usepackage{cleveref}
\usepackage{xcolor}
\usepackage[colorlinks = true,
            linkcolor = black,
            urlcolor  = blue,
            citecolor = black,
            anchorcolor = black]{hyperref}
\usepackage{epstopdf}
\usepackage{braket}
\usepackage{upgreek}
\usepackage{caption}
\usepackage{booktabs}
\usepackage{subcaption}
\usepackage{amssymb,latexsym,amsmath,gensymb}
\usepackage{latexsym}
\usepackage{graphicx}
\usepackage{float}
\usepackage{enumitem}
\usepackage{pdflscape}
\usepackage{url}
\usepackage{array}
\newcolumntype{C}{>{$\displaystyle} c <{$}}
\usepackage{tikz, calc}
\usetikzlibrary{shapes.geometric, arrows, calc}
\tikzstyle{norm} = [rectangle, rounded corners, minimum width=2cm, minimum height=1cm,text centered, draw=black]
\tikzstyle{arrow} = [thick, ->, >=stealth]

\newcommand{\argmin}{\arg\!\min}
\newcommand{\me}{\mathrm{e}}
\providecommand{\e}[1]{\ensuremath{\times 10^{#1}}} 
\providecommand{\mb}[1]{\mathbf{#1}}
\providecommand{\mf}[1]{\mathbf{#1}}
\providecommand{\mc}[1]{\mathcal{#1}}
\providecommand{\ro}[1]{\mathbf{\mathbf{r}}_o}
\providecommand{\so}[1]{\mathbf{\hat{s}}_o}
\providecommand{\rb}[1]{\mathbf{r}_b}
\providecommand{\rbm}[1]{r_b^{\text{m}}}
\providecommand{\rd}[1]{\mathbf{r}_d}
\providecommand{\mh}[1]{\mathbf{\hat{#1}}}
\providecommand{\mbb}[1]{\mathbb{#1}}
\providecommand{\bs}[1]{\boldsymbol{#1}} 
\providecommand{\intinf}{\int_{-\infty}^{\infty}}
\providecommand{\fig}[4]{
  % filename, width, caption, label
\begin{figure}[h]
 \captionsetup{width=1.0\linewidth}
 \centering
 \includegraphics[width = #2\textwidth]{#1}
 \caption{#3}
 \label{fig:#4}
\end{figure}
}

\makeatletter
\renewcommand*\env@matrix[1][*\c@MaxMatrixCols c]{%
  \hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{#1}}
\makeatother

\newcommand{\tensor}[1]{\overset{\text{\tiny$\leftrightarrow$}}{\mb{#1}}}
\newcommand{\tunderbrace}[2]{\underbrace{#1}_{\textstyle#2}}
\providecommand{\figs}[7]{
  % filename1, filename2, caption1, caption2, label1, label2, shift
\begin{figure}[H]
\centering
\begin{minipage}[b]{.45\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{#1}
  \captionsetup{justification=justified, singlelinecheck=true}
  \caption{#3}
  \label{fig:#5}
\end{minipage}
\hspace{2em}
\begin{minipage}[b]{.45\textwidth}
  \centering
  \includegraphics[width=1.0\linewidth]{#2}
  \vspace{#7em}
  \captionsetup{justification=justified}
  \caption{#4}
  \label{fig:#6}
\end{minipage}
\end{figure}
}
\makeatletter

\providecommand{\code}[1]{
\begin{center}
\lstinputlisting{#1}
\end{center}
}

\newcommand{\crefrangeconjunction}{--}
%%%%%%%%%%%
% Spacing %
%%%%%%%%%%%
% Margins
\usepackage[
top    = 1.5cm,
bottom = 1.5cm,
left   = 1.5cm,
right  = 1.5cm]{geometry}

% Indents, paragraph space
%\usepackage{parskip}
\setlength{\parskip}{1.5ex}

% Section spacing
\usepackage{titlesec}
\titlespacing*{\title}
{0pt}{0ex}{0ex}
\titlespacing*{\section}
{0pt}{0ex}{0ex}
\titlespacing*{\subsection}
{0pt}{0ex}{0ex}
\titlespacing*{\subsubsection}
{0pt}{0ex}{0ex}

% Line spacing
\linespread{1.1}

%%%%%%%%%%%%
% Document %
%%%%%%%%%%%%
\begin{document}
\title{\vspace{-2.5em} Singular value decomposition of single view\\ polarized
  fluorescence microscopes\vspace{-1em}} \author{Talon Chandler, Min Guo, Hari
  Shroff, Rudolf Oldenbourg, Patrick La Rivi\`ere}
\date{\vspace{-1em}\today\vspace{-1em}}
\maketitle
\section{Introduction}
In these notes we will develop the continuous models for single view polarized
fluorescence microscopes with either polarized illumination or polarized
detection. We will start by writing an integral transform that maps object space
to data space. Then we will calculate the kernels of the integral transform and
their corresponding transfer functions. Finally we will calculate the singular
value decomposition of the forward operator to find the limits of these designs.

\noindent We will make use of the real circular harmonic functions
\begin{align}
  z_n(\theta) =
  \begin{cases}
    \frac{1}{\sqrt{\pi}}\cos(n\theta), & n > 0,\\
    \frac{1}{\sqrt{\pi}}, & n = 0,\\
    \frac{1}{\sqrt{\pi}}\sin(n\theta), & n < 0.\\
  \end{cases}
\end{align}
The real circular harmonic functions form an orthonormal basis for functions on
the circle because
\begin{align}
  \int_{\mbb{S}^1}d\mh{p}\, z_n(\mh{p})z_{n'}(\mh{p}) = \delta_{nn'}.
\end{align}
Notice that we allow $z_n(\cdot)$ to take a vector argument similar to the
spherical harmonics $y_l^m(\so{})$. This allows us to use these functions
without specifying a coordinate system. Also notice that we are using $n$ to
index the circular harmonic functions---in a previous note set we used $n$ to
index frames or views.

\section{General forward model}
We will consider the problem of imaging a two-dimensional field of oriented
fluorophores. To a good approximation these objects can be represented by a
member of the set
$\mbb{U} = \mbb{L}_2(\mbb{R}^2 \times \mbb{S}^2)$---square-integrable functions
that assign a scalar value to each position and orientation.

These microscopes can collect a two-dimensional frame of intensity measurements
for each position of a single polarizer on the illumination or detection arm.
Therefore, the collected data is a member of the set
$\mbb{V} = \mbb{L}_2(\mbb{R}^2 \times \mbb{S}^1)$---square-integrable functions
that assign a scalar value to each two-dimensional position on a circle. Notice
that we are considering the largest possible data space for these
microscopes---a continuous sampling of the spatial and polarizer dimensions.
This approach allows us to answer questions about the limits of these
microscopes without considering specific choices of spatial sampling (pixels) or
polarization sampling (polarizer settings). It will be helpful to think of the
space $\mbb{L}_2(\mbb{R}^2 \times \mbb{S}^1)$ geometrically as a continuous list
of images arranged face to face in a donut---if we slice the donut along the
smaller dimension (not like a pre-cut bagel!) we can see a single
image taken with a single polarizer setting.

If the imaging system is spatially shift-invariant, then the forward and adjoint operators are given by the following integral transforms
\begin{align}
  g(\rd{}, \mh{p}) = [\mathcal{H}f](\rd{}, \hat{\mb{p}}) &= \int_{\mbb{S}^2}d\so{}\int_{\mbb{R}^2}d\ro{}\, h(\rd{} -\ro{}, \so{}; \hat{\mb{p}})f(\ro{}, \so{}),\\
  f(\ro{}, \so{}) =  [\mathcal{H}^{\dagger}g](\ro{}, \so{}) &= \int_{\mbb{S}^1}d\hat{\mb{p}}\, \int_{\mbb{R}^2}d\mb{r}_{d}\, h(\rd{} - \ro{}, \so{}; \hat{\mb{p}})g(\rd{}, \hat{\mb{p}}).
\end{align}
where $f(\ro{}, \so{})$ is the object, $g(\rd{}, \hat{\mb{p}})$ is the data, and
$h(\rd{} -\ro{}, \so{}; \hat{\mb{p}})$ is the kernel of the integral transform.
The kernel can be interpreted as a ``point spread function'' if we visualize the
complete data space as a ``donut'' of images. A delta function at a point in object
space will give rise to the kernel evaluated at that point in data space.

We can write the forward and adjoint operators in the frequency domain as
% \begin{align}
%   g(\rd{}, \hat{\mb{p}}) = \sum_{n=-\infty}^{\infty} z_n(\mh{p}) \sum_{l=0}^{\infty}\sum_{m=-l}^{l} \int_{\mbb{R}^2}d\bs{\nu}\, H_{l,n}^m(\bs{\nu})F_l^m(\bs{\nu}), 
    %   \end{align}
\begin{align}
  G_n(\bs{\nu}) &= \sum_{l=0}^{\infty}\sum_{m=-l}^{l}H_{l,n}^m(\bs{\nu})F_l^m(\bs{\nu}),\label{eq:fwd}\\
  F_l^m(\bs{\nu}) &= \sum_{n=-\infty}^{\infty}H_{l,n}^m(\bs{\nu})G_n(\bs{\nu}),
\end{align}
where
\begin{align}
  G_{n}(\bs{\nu}) &= \int_{\mbb{S}^1}d\mh{p}\, z_n(\mh{p})\int_{\mbb{R}^2}d\rd{}\, \me{}^{i2\pi\rd{}\cdot\bs{\nu}}g(\rd{}, \mh{p}),\\
  H_{l,n}^m(\bs{\nu}) &= \int_{\mbb{S}^1}d\mh{p}\, z_n(\mh{p})\int_{\mbb{S}^2}d\so{}\, y_l^m(\so{})\int_{\mbb{R}^2}d\ro{}\, \me{}^{i2\pi\ro{}\cdot\bs{\nu}}h(\ro{}, \so{}; \mh{p}),\\
  F_{l}^m(\bs{\nu}) &= \int_{\mbb{S}^2}d\so{}\, y_l^m(\so{})\int_{\mbb{R}^2}d\ro{}\, \me{}^{i2\pi\ro{}\cdot\bs{\nu}}f(\ro{}, \so{}).
\end{align}
To find the singular value decomposition of the forward operator, we need to solve
\begin{align}
  \mc{H}\mc{H}^{\dagger} v_{\bs{\rho},j}(\rd{}, \hat{\mb{p}}) = \mu_{\bs{\rho},j}v_{\bs{\rho},j}(\rd{}, \hat{\mb{p}}). 
\end{align}
It is much easier to solve the equivalent problem in the frequency domain
\begin{align}
  \mathsf{K}(\bs{\rho})\mathsf{V}_j(\bs{\rho}) = \mu_{\bs{\rho},j}\mathsf{V}_j(\bs{\rho}). \label{eq:freqsvd}
\end{align}
where the entries of $\mathsf{K}(\bs{\rho})$ are given by
\begin{align}
  K_{nn'}(\bs{\rho}) = \sum_{l=0}^\infty\sum_{m=-l}^{l}H_{l,n}^m(\bs{\rho})H_{l,n'}^m(\bs{\rho}),
\end{align}
and the entries of $\mathsf{V}_j(\bs{\rho})$ are related to the complete data space singular functions by
\begin{align}
  v_{\bs{\rho},j}(\rd{}, \mh{p}) = \me{}^{i 2\pi \bs{\rho}\cdot\rd{}}\sum_{n=-\infty}^{\infty}[V_n(\bs{\rho})]_j z_n(\mh{p}). \label{eq:eigfunc}
\end{align}
Once we've found the data space singular functions, we can find the object space singular functions using
\begin{align}
  [U_l^m(\bs{\rho})]_j &= \sum_{n=-\infty}^{\infty} H_{l,n}^m(\bs{\rho})[V_n(\bs{\rho})]_j, \label{eq:eigenfuncobj}\\
  u_{\bs{\rho}, j}(\ro{}, \so{}) &= \me{}^{i2\pi\bs{\rho}\cdot\ro{}}\sum_{l=0}^{\infty}\sum_{m=-l}^l [U_l^m(\bs{\rho})]_j y_l^m(\so{}).
\end{align}

\section{Polarized illumination}
\subsection{Kernel}
In previous notes we showed that the excitation point response function for
polarized epi-illumination is given by
\begin{align}
  h^{\mh{z}}_{\text{exc}}(\so{}; \mh{p}) &= y_0^0(\so{}) - \frac{1}{\sqrt{5}}\tilde{A}y_2^0(\so{}) + \sqrt{\frac{3}{5}}\tilde{B}\left\{[(\mh{p}\cdot\mh{x})^2 - (\mh{p}\cdot\mh{y})^2]y_2^2(\so{}) - 2(\mh{p}\cdot\mh{x})(\mh{p}\cdot\mh{y})y_2^{-2}(\so{})\right\}, \label{eq:genpsf}
\end{align}
where
\begin{subequations}
\begin{align}
  \tilde{A} &\equiv \cos^2(\alpha/2)\cos(\alpha),\\
  \tilde{B} &\equiv \frac{1}{12}(\cos^2\alpha + 4\cos\alpha + 7),
\end{align}\label{eq:coefficients}%
\end{subequations}
and $\alpha \equiv \arcsin(\text{NA}/n_o)$. It is more convenient to write the point response function in terms of the circular harmonics
\begin{align}
    h^{\mh{z}}_{\text{exc}}(\so{}; \mh{p}) &= y_0^0(\so{}) - \frac{1}{\sqrt{5}}\tilde{A}y_2^0(\so{}) + \sqrt{\frac{3}{5}}\tilde{B}\left\{y_2^2(\so{})z_2(\mh{p}) - y_2^{-2}(\so{})z_{-2}(\mh{p})\right\}.
\end{align}

We also showed that the point response function for unpolarized epi-detection is
given by
\begin{align}
  h_{\text{det}}(\ro{}, \so{}) &= [{a}^2(r_o) + 2b^2(r_o)]y_0^0(\so{}) + \frac{1}{\sqrt{5}}\left[- a^2(r_o) + 4b^2(r_o)\right]y_2^0(\so{}),
\end{align}
where
\begin{align}
  a(r_o) = \frac{J_1(2\pi \nu_or_o)}{\pi \nu_or_o}, 
  &\hspace{2em}
    b(r_o) = \frac{\text{NA}}{n_o}\left[\frac{J_2(2\pi \nu_or_o)}{\pi \nu_or_o}\right],  \label{eq:abparadef}
  \intertext{and}
  \nu_o \equiv \frac{\text{NA}}{\lambda},&\hspace{2em}
  \text{NA} = n_o\sin\alpha.
\end{align}
The excitation and detection processes are incoherent, so to find the complete
point response function we can multiply the excitation and detection point response
functions which gives
\begin{align}
  h(\ro{}, \so{}; \mh{p}) = h^{\mh{z}}_{\text{exc}}(\so{}; \mh{p})h_{\text{det}}(\ro{}, \so{}) = \frac{1}{\tilde{N}}\sum_{l=0}^{\infty}\sum_{m=-l}^l\sum_{n=-\infty}^{\infty} h_{l,n}^m(\ro{})y_l^m(\so{})z_n(\mh{p}), 
\end{align}
where $\tilde{N} = \frac{\tilde{A}}{10} + \frac{1}{2}$ is a normalization constant
and the terms in the series are given by
\begin{align}
  h_{0,0}^0(r_o) &= \left[\frac{\tilde{A}}{10} + \frac{1}{2}\right]a^2(r_o) + \left[-\frac{2\tilde{A}}{5} + 1\right]b^2(r_o),\\
  h_{2,2}^{2}(r_o) &= -h_{2,-2}^{-2}(r_o) = \frac{3\sqrt{15}\tilde{B}}{35}\left[\frac{3}{2}a^2(r_o) + b^2(r_o)\right],\\
  h_{2,0}^0(r_o) &= \left[-\frac{\sqrt{5}\tilde{A}}{14} + \frac{\sqrt{5}}{10}\right]a^2(r_o) + \left[-\frac{11\sqrt{5}\tilde{A}}{35} + \frac{2}{\sqrt{5}}\right]b^2(r_o),\\
  h_{4,2}^{2}(r_o) &= -h_{4,-2}^{-2}(r_o) = \frac{6\sqrt{5}\tilde{B}}{35}\left[-\frac{1}{4}a^2(r_o) + b^2(r_o)\right],\\
  h_{4,0}^0(r_o) &= \frac{3\tilde{A}}{35}[a^2(r_o) - 4b^2(r_o)],\\
\end{align}
and all other $h_{l,n}^m(r_o)$ terms in the series are zero. 

\subsection{Transfer function}
The optical transfer function for this microscope is given by
\begin{align}
  H_{l,n}^m(\nu) = \frac{1}{\tilde{M}}\sum_{l'=0}^{\infty}\sum_{m'=-l'}^{l'}\sum_{n'=-\infty}^{\infty} H_{l',n'}^{m'}(\nu)\delta_{l,l'}\delta_{m,m'}\delta_{n,n'},  
\end{align}
where
$\tilde{M} = \left[\frac{\tilde{A}}{10} + \frac{1}{2}\right] + \left(\frac{\text{NA}}{n_o}\right)\left[-\frac{2\tilde{A}}{10} + \frac{1}{2}\right]$ is a
normalization constant, and
\begin{align}
  H_{0,0}^0(\nu) &= \left[\frac{\tilde{A}}{10} + \frac{1}{2}\right]A(\nu) + \left[-\frac{2\tilde{A}}{5} + 1\right]B(\nu),\\
  H_{2,2}^{2}(\nu) &= -H_{2,-2}^{-2}(\nu) = \frac{3\sqrt{15}\tilde{B}}{35}\left[\frac{3}{2}A(\nu) + B(\nu)\right],\\
  H_{2,0}^0(\nu) &= \left[-\frac{\sqrt{5}\tilde{A}}{14} + \frac{\sqrt{5}}{10}\right]A(\nu) + \left[-\frac{11\sqrt{5}\tilde{A}}{35} + \frac{2}{\sqrt{5}}\right]B(\nu),\\
  H_{4,2}^{2}(\nu) &= -H_{4,-2}^{-2}(\nu) = \frac{6\sqrt{5}\tilde{B}}{35}\left[-\frac{1}{4}A(\nu) + B(\nu)\right],\\
  H_{4,0}^0(\nu) &= \frac{3\tilde{A}}{35}[A(\nu) - 4B(\nu)],
\end{align}
and all other $H_{l,n}^m(\nu)$ terms in the series are zero, and  
\begin{align}
  A(\nu) &= \frac{2}{\pi}\left[\arccos\left(\frac{\nu}{2\nu_o}\right) - \frac{\nu}{2\nu_o}\sqrt{1 - \left(\frac{\nu}{2\nu_o}\right)^2}\right]\Pi\left(\frac{\nu}{2\nu_o}\right),\\
  B(\nu) &= \frac{1}{\pi}\left(\frac{\text{NA}}{n_o}\right)^2\left[\arccos\left(\frac{\nu}{2\nu_o}\right) - \left[3 - 2\left(\frac{\nu}{2\nu_o}\right)^2\right]\frac{\nu}{2\nu_o} \sqrt{1 - \left(\frac{\nu}{2\nu_o}\right)^2}\right]\Pi\left(\frac{\nu}{2\nu_o}\right).                 
\end{align}

\subsection{Singular value decomposition}
Plugging the transfer function into the frequency-domain eigenvalue problem (Eq.
\ref{eq:freqsvd}) yields a $3\times 3$ eigenvalue problem (we suppress the index
$\bs{\rho}$ and understand that we need to solve this eigenvalue problem at each
value of $\bs{\rho}$)
\begin{align}
  \mathsf{K}\mathsf{V}_j &= \mu_{j}\mathsf{V}_j,\\
  \begin{bmatrix}
    \sum_{l,m}H_{l,-2}^{m}H_{l,-2}^{m}&\sum_{l,m}H_{l,-2}^{m}H_{l,0}^{m}&\sum_{l,m}H_{l,-2}^{m}H_{l,2}^{m}\\
    \sum_{l,m}H_{l,0}^{m}H_{l,-2}^{m}&\sum_{l,m}H_{l,0}^{m}H_{l,0}^{m}&\sum_{l,m}H_{l,0}^{m}H_{l,2}^{m}\\
    \sum_{l,m}H_{l,2}^{m}H_{l,-2}^{m}&\sum_{l,m}H_{l,2}^{m}H_{l,0}^{m}&\sum_{l,m}H_{l,2}^{m}H_{l,2}^{m}\\    
  \end{bmatrix}\mathsf{V}_j
&= \mu_{j}\mathsf{V}_j,\\
  \begin{bmatrix}
    \{H_{2,-2}^{-2}\}^2 + \{H_{4,-2}^{-2}\}^2&0&0\\
    0&\{H_{0,0}^{0}\}^2 + \{H_{2,0}^{0}\}^2 + \{H_{4,0}^{0}\}^2&0\\
    0&0&\{H_{2,2}^{2}\}^2 + \{H_{4,2}^{2}\}^2\\    
  \end{bmatrix}\mathsf{V}_j
&= \mu_{j}\mathsf{V}_j.
\end{align}
A diagonal matrix has its eigenvalues along the diagonal and its eigenvectors as
unit vectors so
\begin{align}
  \mu_{\bs{\rho},0} &= \{H_{0,0}^{0}(\rho)\}^2 + \{H_{2,0}^{0}(\rho)\}^2 + \{H_{4,0}^{0}(\rho)\}^2,\\
  \mu_{\bs{\rho},1} = \mu_{\bs{\rho},2} &= \{H_{2,2}^{2}(\rho)\}^2 + \{H_{4,2}^{2}(\rho)\}^2,
\end{align}
and
\begin{align}
  \mathsf{V}_0 =
  \begin{bmatrix}
    0\\1\\0\\
  \end{bmatrix},\qquad
  \mathsf{V}_1 =
  \begin{bmatrix}
    1\\0\\0\\
  \end{bmatrix},\qquad
  \mathsf{V}_2 =
  \begin{bmatrix}
    0\\0\\1\\
  \end{bmatrix}.
\end{align}
Notice that we have two degenerate eigenvalues, but we have found trivial
orthonormal eigenvectors---in general we will need to apply the Gram-Schmidt
procedure.

% We can substitute the $H_{l,n}^m$ functions to recover the complete eigenvalue
% spectrum as
% \begin{align}
%   \mu_{\bs{\rho},0} = &\frac{1}{70}[3\tilde{A}^2A^2(\rho) +2\tilde{A}A^2(\rho) + 21A^2(\rho) + 6\tilde{A}^2A(\rho)B(\rho) - 56\tilde{A}A(\rho)B(\rho) + \\ & \qquad 98A(\rho)B(\rho) + 54\tilde{A}^2B(\rho)^2 - 144\tilde{A}B^2(\rho) + 126B^2(\rho)],\\
%   \mu_{\bs{\rho},1} = &\mu_{\bs{\rho}, 2} = \frac{9\tilde{B}}{35}[A^2(\rho) + A(\rho)B(\rho) + B^2(\rho)].
% \end{align}
We can use Eq. \ref{eq:eigfunc} to recover the complete singular functions in
data space as
\begin{align}
  v_{\bs{\rho},0}(\rd{}, \mh{p}) &= \me{}^{i2\pi\bs{\rho}\cdot\rd{}}z_0(\mh{p}),\\
  v_{\bs{\rho},1}(\rd{}, \mh{p}) &= \me{}^{i2\pi\bs{\rho}\cdot\rd{}}z_{-2}(\mh{p}),\\
  v_{\bs{\rho},2}(\rd{}, \mh{p}) &= \me{}^{i2\pi\bs{\rho}\cdot\rd{}}z_2(\mh{p}).
\end{align}
For the final step we use Eq. \ref{eq:eigenfuncobj} to find the spectra of the
singular functions in object space
\begin{align}
  [U_l^m(\rho)]_0 &= H_{l,0}^m(\rho) = H_{0,0}^0(\rho)\delta_{l0}\delta_{m0} + H_{2,0}^0(\rho)\delta_{l2}\delta_{m0} + H_{4,0}^0(\rho)\delta_{l4}\delta_{m0},\\
  [U_l^m(\rho)]_1 &= H_{l,-2}^m(\rho) = H_{2,-2}^{-2}(\rho)\delta_{l2}\delta_{m-2} + H_{4,-2}^{-2}(\rho)\delta_{l4}\delta_{m-2},\\
  [U_l^m(\rho)]_2 &= H_{l,2}^m(\rho) = H_{l,2}^m(\rho) = H_{2,2}^{2}(\rho)\delta_{l2}\delta{m2} + H_{4,2}^{2}(\rho)\delta_{l4}\delta_{m2}.
\end{align}
Therefore, the complete singular functions in object space are
\begin{align}
  u_{\bs{\rho},0}(\ro{}, \so{}) &= \me{}^{i2\pi\bs{\rho}\cdot\ro{}}[H_{0,0}^0(\rho)y_0^0(\so{}) + H_{2,0}^0(\rho)y_2^0(\so{}) + H_{4,0}^0(\rho)y_4^0(\so{})],\\
  u_{\bs{\rho},1}(\ro{}, \so{}) &= \me{}^{i2\pi\bs{\rho}\cdot\ro{} }[H_{2,-2}^{-2}(\rho)y_2^{-2}(\so{}) + H_{4,-2}^{-2}(\rho)y_4^{-2}(\so{})],\\
  u_{\bs{\rho},2}(\ro{}, \so{}) &= \me{}^{i2\pi\bs{\rho}\cdot\ro{} }[H_{2,2}^2(\rho)y_2^2(\so{}) + H_{4,2}^2(\rho)y_4^2(\so{})].
\end{align}

We have found the complete singular system for a single view microscope with
polarized illumination. We can look closer at the singular value spectrum to
find the degeneracies of the microscope. The first major set of degeneracies is
related to the fact that $\mu_{\bs{\rho},1} = \mu_{\bs{\rho},2}$. The
corresponding singular functions in object space are related by changing the
spherical harmonic index $m$ to $-m$. This transformation is a rotation about
the optical axis, so this degeneracy corresponds to the rotational symmetry of
the microscope. The second set of degeneracies is related to the fact that the
singular values depend only on $\rho$, not the vector $\bs{\rho}$. The
corresponding singular functions in object space are spatial harmonics at the
same spatial frequency in different directions. Once again, this degeneracy
corresponds to the rotational symmetry of the microscope.

Recall the mental image of data space being arranged on a donut. If we rotate
the object that we are imaging then the data space will undergo two simultaneous
rotations---one rotation about an axis through the donut hole (imagine sticking
your finger through the donut) and another about the curved axis that runs
through the center of the dough (imagine twisting the donut in on itself so that
glaze on top would end up on the bottom). These two simultaneous rotations
correspond with the two sets of degeneracies we see in the singular value
spectrum.

Plots forthcoming!

\section{Polarized detection}
We'll use the same notation as the previous section, so there will be notation
overlap.

\subsection{Kernel}
In previous notes we showed that the excitation point response function for
unpolarized epi-illumination is given by
\begin{align}
  h_{\text{exc}}^{\mh{z}}(\so{}) = h_{\text{exc},0,0}^0y_0^0(\so{}) + h_{\text{exc},0,0}^2y_2^0(\so{}).
\end{align}
where
\begin{align}
  h_{\text{exc},0,0}^0 &= 1,\\
  h_{\text{exc},2,0}^0 &= -\frac{1}{\sqrt{5}}\tilde{A}.
\end{align}

We also showed that the point response function for polarized detection is given
by (rewritten in terms of the circular harmonics)
\begin{align}
  h_{\text{det}}(\ro{}, \so{}; \mh{p}) = \sum_{l=0}^{\infty}\sum_{m=-l}^l\sum_{n=-\infty}^{\infty} h_{\text{det},l,n}^m(\ro{})y_l^m(\so{})z_n(\mh{p}_d), 
\end{align}
where
\begin{align}
  h_{\text{det},0,0}^0(\ro{}) &= a^2(r_o) + 2b^2(r_0),\\
  h_{\text{det},0,\pm 2}^0(\ro{}) &= 2\sqrt{\pi} b^2(r_0)z_{\pm 2}(\ro{}),\\
  h_{\text{det},2,0}^0(\ro{}) &= \frac{1}{\sqrt{5}}\left[-a^2(r_o) + 4b^2(r_0)\right],\\
  h_{\text{det},2,\pm 2}^0(\ro{}) &= 4\sqrt{\frac{\pi}{5}}b^2(r_0)z_{\pm 2}(\ro{}),\\
  h_{\text{det},2,2}^2(\ro{}) &= -h_{\text{det},2,-2}^{-2}(\ro{}) = \sqrt{\frac{3}{5}}a^2(r_o).
\end{align}
The complete kernel for unpolarized illumination and polarized detection is given by
\begin{align}
  h(\ro{}, \so{}; \mh{p}_d) = h_{\text{exc}}(\so{})h_{\text{det}}(\ro{}, \so{}; \mh{p}_d) = \sum_{l=0}^{\infty}\sum_{m=-l}^l\sum_{n=-\infty}^{\infty} h_{l,n}^m(\ro{})y_l^m(\so{})z_n(\mh{p}_d), 
\end{align}
where
\begin{align}
  h_{0,0}^0(\ro{}) &= h_{\text{exc},0,0}^0 h_{\text{det},0,0}^0(\ro{}) + h_{\text{exc},2,0}^0 h_{\text{det},2,0}^0(\ro{}),\\
  h_{0,\pm 2}^0(\ro{}) &= h_{\text{exc},0,0}^0 h_{\text{det},0,\pm 2}^0(\ro{}) + h_{\text{exc},2,0}^0 h_{\text{det},2,\pm 2}^0(\ro{}),\\
  h_{2,0}^0(\ro{}) &= h_{\text{exc},0,0}^0 h_{\text{det},0,0}^0(\ro{}) + h_{\text{exc},2,0}^0 h_{\text{det},2,0}^0(\ro{}) + \frac{2\sqrt{5}}{7}h_{\text{exc},2,0}^0h_{\text{det},2,0}^0(\ro{}),\\
  h_{2,\pm 2}^0(\ro{}) &= h_{\text{exc},0,0}^0 h_{\text{det},0,\pm 2}^0(\ro{}) + h_{\text{exc},2,0}^0 h_{\text{det},2,\pm 2}^0(\ro{}) + \frac{2\sqrt{5}}{7}h_{\text{exc},2,0}^0h_{\text{det},2,\pm 2}^0(\ro{}),\\
  h_{2,\pm 2}^{\pm 2}(\ro{}) &= h_{\text{det},2,\pm 2}^{\pm 2}(\ro{})\left[h_{\text{exc},0,0}^0 - \frac{2\sqrt{5}}{7}h_{\text{exc},2,0}^0\right],\\
  h_{4,0}^0(\ro{}) &= \frac{6}{7}h_{\text{exc},2,0}^0h_{\text{det},2,0}^0(\ro{}),\\
  h_{4,\pm 2}^0(\ro{}) &= \frac{6}{7}h_{\text{exc},2,0}^0h_{\text{det},2,\pm 2}^0(\ro{}),\\
  h_{4,\pm 2}^{\pm 2}(\ro{}) &= \frac{\sqrt{15}}{7}h_{\text{exc},2,0}^0h_{\text{det},2,\pm 2}^{\pm 2}(\ro{}),
\end{align}
% hh0
% [h000d*h000e + h200d*h200e, 0, 0, h000d*h200e + h000e*h200d + 2*sqrt(5)*h200d*h200e/7, 0, 0, 0, 0, 0, 0, 6*h200d*h200e/7, 0, 0, 0, 0]

% hh2
% [h000e*h002d + h200e*h202d, 0, 0, h000e*h202d + h002d*h200e + 2*sqrt(5)*h200e*h202d/7, 0, h222d*(7*h000e - 2*sqrt(5)*h200e)/7, 0, 0, 0, 0, 6*h200e*h202d/7, 0, sqrt(15)*h200e*h222d/7, 0, 0]

% hh_2
% [h000e*h00_2d + h200e*h20_2d, h2_2_2d*(7*h000e - 2*sqrt(5)*h200e)/7, 0, h000e*h20_2d + h00_2d*h200e + 2*sqrt(5)*h200e*h20_2d/7, 0, 0, 0, 0, sqrt(15)*h200e*h2_2_2d/7, 0, 6*h200e*h20_2d/7, 0, 0, 0, 0]
and the remaining terms in the series are zero. Plugging in the excitation and
detection point response functions gives the following
\begin{align}
  h_{0,0}^0(\ro{}) &= \left[\frac{\tilde{A}}{5} + 1\right]a^2(r_o) + \left[-\frac{4\tilde{A}}{5} + 2\right]b^2(r_o),\\ 
  h_{0,\pm 2}^0(\ro{}) &= 2\sqrt{\pi}\left[1 - \frac{2\tilde{A}}{5}\right]b^2(r_o)z_{\pm 2}(\ro{}),\\ 
  h_{2,0}^0(\ro{}) &= \frac{\sqrt{5}}{35}\left\{-\left[5\tilde{A} + 7\right]a^2(r_o) + \left[-22\tilde{A} + 28\right]b^2(r_0)\right\},\\ 
  h_{2,\pm 2}^0(\ro{}) &= \frac{2\sqrt{5\pi}}{35}\left[-11\tilde{A} + 14\right]b^2(r_o)z_{\pm 2}(\ro{})\\ 
  h_{2,2}^{2}(\ro{}) &= h_{2,-2}^{-2}(\ro{}) = \frac{\sqrt{15}}{5}\left[\frac{2\tilde{A}}{7} + 1\right]a^2(r_o),\\ 
  h_{4,0}^0(\ro{}) &= \frac{6\tilde{A}}{35}\left[a^2(r_o) - 4b^2(r_o)\right],\\ 
  h_{4,\pm 2}^0(\ro{}) &= -\frac{24\sqrt{\pi}}{35}\tilde{A}b^2(r_o)z_{\pm 2}(\ro{}),\\ 
  h_{4,2}^{2}(\ro{}) &= h_{4,-2}^{-2}(\ro{}) = -\frac{3\sqrt{5}}{35}\tilde{A}a^2(r_o). 
\end{align}
% hh0
% [At*(a - 4*b)/5 + a + 2*b, 0, 0, sqrt(5)*(-5*At*a - 22*At*b - 7*a + 28*b)/35, 0, 0, 0, 0, 0, 0, 6*At*(a - 4*b)/35, 0, 0, 0, 0]

% hh2
% [2*sqrt(pi)*b*z2*(-2*At + 5)/5, 0, 0, 2*sqrt(5)*sqrt(pi)*b*z2*(-11*At + 14)/35, 0, a*(2*sqrt(15)*At/35 + sqrt(15)/5), 0, 0, 0, 0, -24*sqrt(pi)*At*b*z2/35, 0, -sqrt(15)*sqrt(3)*At*a/35, 0, 0]

% hh_2
% [2*sqrt(pi)*b*z_2*(-2*At + 5)/5, a*(0.221313334068995*At + 0.774596669241483), 0, 2*sqrt(5)*sqrt(pi)*b*z_2*(-11*At + 14)/35, 0, 0, 0, 0, -0.110656667034498*sqrt(3)*At*a, 0, -24*sqrt(pi)*At*b*z_2/35, 0, 0, 0, 0]


\subsection{Transfer function}
The transfer function for unpolarized illumination and polarized detection is
given by
\begin{align}
  H_{l,n}^m(\bs{\nu}) = \sum_{l=0}^{\infty}\sum_{m=-l}^l\sum_{n=-\infty}^{\infty} H_{l,n}^m(\bs{\nu})\delta_{ll'}\delta_{mm'}\delta_{nn'},
\end{align}
where
\begin{align}
  H_{0,0}^0(\bs{\nu}) &= \left[\frac{\tilde{A}}{5} + 1\right]A(\nu) + \left[-\frac{4\tilde{A}}{5} + 2\right]B(\nu),\\ 
  H_{0,\pm 2}^0(\bs{\nu}) &= 2\sqrt{\pi}\left[1 - \frac{2\tilde{A}}{5}\right]C(\nu)z_{\pm 2}(\bs{\nu}),\\ 
  H_{2,0}^0(\bs{\nu}) &= \frac{\sqrt{5}}{35}\left\{-\left[5\tilde{A} + 7\right]A(\nu) + \left[-22\tilde{A} + 28\right]B(r_0)\right\},\\ 
  H_{2,\pm 2}^0(\bs{\nu}) &= \frac{2\sqrt{5\pi}}{35}\left[-11\tilde{A} + 14\right]C(\nu)z_{\pm 2}(\bs{\nu})\\ 
  H_{2,2}^{2}(\bs{\nu}) &= H_{2,-2}^{-2}(\bs{\nu}) = \frac{\sqrt{15}}{5}\left[\frac{2\tilde{A}}{7} + 1\right]A(\nu),\\ 
  H_{4,0}^0(\bs{\nu}) &= \frac{6\tilde{A}}{35}\left[A(\nu) - 4B(\nu)\right],\\ 
  H_{4,\pm 2}^0(\bs{\nu}) &= -\frac{24\sqrt{\pi}}{35}\tilde{A}C(\nu)z_{\pm 2}(\bs{\nu}),\\ 
  H_{4,2}^{2}(\bs{\nu}) &= H_{4,-2}^{-2}(\bs{\nu}) = -\frac{3\sqrt{5}}{35}\tilde{A}A(\nu). 
\end{align}
where 
\begin{align}
  A(\nu) &= \frac{2}{\pi}\left[\arccos\left(\frac{\nu}{2\nu_o}\right) - \frac{\nu}{2\nu_o}\sqrt{1 - \left(\frac{\nu}{2\nu_o}\right)^2}\right]\Pi\left(\frac{\nu}{2\nu_o}\right),\\
  B(\nu) &= \frac{1}{\pi}\left(\frac{\text{NA}}{n_o}\right)^2\left[\arccos\left(\frac{\nu}{2\nu_o}\right) - \left[3 - 2\left(\frac{\nu}{2\nu_o}\right)^2\right]\frac{\nu}{2\nu_o} \sqrt{1 - \left(\frac{\nu}{2\nu_o}\right)^2}\right]\Pi\left(\frac{\nu}{2\nu_o}\right),\\
  C(\nu) &= \frac{1}{\pi}\left(\frac{\text{NA}}{n_o}\right)^2\left[-\frac{4}{3}\frac{\nu}{2\nu_o}\sqrt[3]{1 - \left(\frac{\nu}{2\nu_o}\right)^2}\right]\Pi\left(\frac{\nu}{2\nu_o}\right).
\end{align}

\subsection{Singular value decomposition}
We follow the same procedure and plug the transfer function into the
frequency-domain eigenvalue problem (Eq. \ref{eq:freqsvd}) which gives a
$3\times 3$ eigenvalue problem
\begin{align}
  \mathsf{K}\mathsf{V}_j &= \mu_{j}\mathsf{V}_j,
\end{align}
where the entries of $\mathsf{K}$ are given by
\begin{align}
  \mathsf{K}_{00} &= \sum_{l,m}H_{l,-2}^{m}H_{l,-2}^{m} = \{H_{0,-2}^{0}\}^2 + \{H_{2,-2}^{-2}\}^2 + \{H_{2,-2}^{0}\}^2 + \{H_{4,-2}^{-2}\}^2 + \{H_{4,-2}^{0}\}^2,\\
  \mathsf{K}_{11} &= \sum_{l,m}H_{l,0}^{m}H_{l,0}^{m} = \{H_{0,0}^{0}\}^2 + \{H_{2,0}^{0}\}^2 + \{H_{4,0}^{0}\}^2,\\
  \mathsf{K}_{22} &= \sum_{l,m}H_{l,2}^{m}H_{l,2}^{m} = \{H_{0,2}^{0}\}^2 + \{H_{2,2}^{2}\}^2 + \{H_{2,2}^{0}\}^2 + \{H_{4,2}^{2}\}^2 + \{H_{4,2}^{0}\}^2,\\
  \mathsf{K}_{01} &= \mathsf{K}_{10} = \sum_{l,m}H_{l,-2}^{m}H_{l,0}^{m} = H_{0,-2}^{0}H_{0,0}^{0} + H_{2,-2}^{0}H_{2,0}^{0} + H_{4,-2}^{0}H_{4,0}^{0},\\
  \mathsf{K}_{02} &= \mathsf{K}_{20} = \sum_{l,m}H_{l,-2}^{m}H_{l,2}^{m} = H_{0,-2}^{0}H_{0,2}^{0} + H_{2,-2}^{0}H_{2,2}^{0} + H_{4,-2}^{0}H_{4,2}^{0},\\
  \mathsf{K}_{12} &= \mathsf{K}_{21} = \sum_{l,m}H_{l,0}^{m}H_{l,2}^{m} = H_{0,0}^{0}H_{0,2}^{0} + H_{2,0}^{0}H_{2,2}^{0} + H_{4,0}^{0}H_{4,2}^{0}.
\end{align}
The eigenvalues and eigenvectors can be computed in a closed form (and I've done
this using a symbolic package), but writing the result would fill several pages
with notation and provide little insight. Instead we proceed straight to plots
of the eigenvalues and eigenvectors shown in Fig. XXX. 

\bibliography{report}{}
\bibliographystyle{unsrt}

\end{document}
